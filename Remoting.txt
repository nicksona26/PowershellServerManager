# interactive remote session
Enter-PSSession -ComputerName FS-NUG

# create a new session and copy files to it
$s = New-PSSession -ComputerName FS-NUG
Copy-Item -Path c:\Nuggetlab\ -Destination c:\ -Recurse -ToSession $s
Enter-PSSession $s

# send commands to a machine
Invoke-Command -ComputerName FS-NUG -ScriptBlock { Get-Service }

# send commands to multiple machines
Invoke-Command -ComputerName FS-NUG, SRV-NUG, DC-NUG -ScriptBlock { Get-Service wuau* }

# send a script to multiple machines
Invoke-Command -ComputerName FS-NUG, SRV-NUG, DC-NUG -FilePath C:\Nuggetlab\MonitorServices.ps1

# configure execution policy
Get-ExecutionPolicy
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned

